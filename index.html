<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Ù„Ø¹Ø¨Ø© Ù…Ø§Ø±ÙŠÙˆ - Ø§Ù„Ù‡Ø§ØªÙ</title>
    <style>
        /* ğŸ”¥ RESET */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }
        
        body, html {
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            position: fixed;
            background: #000;
            color: white;
            font-family: Arial, sans-serif;
        }
        
        /* ğŸ”¥ Ø´Ø§Ø´Ø© ØªØ¯ÙˆÙŠØ± Ø§Ù„Ù‡Ø§ØªÙ */
        #rotate-warning {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: #000;
            color: #FFD700;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            z-index: 9999;
            padding: 20px;
        }
        
        @media (orientation: portrait) {
            #rotate-warning { display: flex; }
            #game-container { display: none !important; }
        }
        
        /* ğŸ”¥ Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù„Ø¹Ø¨Ø© */
        #game-container {
            width: 100vw;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            background: #000;
            display: flex;
            flex-direction: column;
        }
        
        /* ğŸ”¥ Ø²Ø± Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø© */
        #fullscreen-btn {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 40px;
            height: 40px;
            background: rgba(0,0,0,0.7);
            border: 2px solid #FFD700;
            color: #FFD700;
            border-radius: 50%;
            font-size: 1.2rem;
            z-index: 1000;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* ğŸ”¥ Ø§Ù„Ø´Ø§Ø´Ø§Øª */
        .screen {
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
        }
        
        .screen.active {
            display: flex;
        }
        
        /* ğŸ”¥ Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© - SIMPLE */
        #start-screen h1 {
            color: #FFD700;
            font-size: 2.5rem;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .start-buttons {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 100%;
            max-width: 300px;
            margin-top: 40px;
        }
        
        .game-btn {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
            border: none;
            padding: 20px;
            font-size: 1.3rem;
            font-weight: bold;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .game-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(46, 204, 113, 0.4);
        }
        
        .game-btn:active {
            transform: translateY(0);
        }
        
        #howto-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }
        
        /* ğŸ”¥ Ø´Ø§Ø´Ø© Ø§Ù„Ù„Ø¹Ø¨ */
        #game-screen {
            padding: 0;
            background: #000;
        }
        
        .game-header {
            width: 100%;
            background: rgba(0,0,0,0.8);
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 3px solid #FFD700;
        }
        
        .stats {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .stat {
            background: rgba(255,255,255,0.1);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .game-area {
            flex: 1;
            position: relative;
            width: 100%;
            overflow: hidden;
        }
        
        #game-canvas {
            width: 100%;
            height: 100%;
            display: block;
            background: #87CEEB;
        }
        
        /* ğŸ”¥ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ù„Ù„Ù‡Ø§ØªÙ */
        .mobile-controls {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 100;
        }
        
        .control-group {
            display: flex;
            gap: 20px;
        }
        
        .mobile-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: rgba(0,0,0,0.7);
            border: 3px solid #FFD700;
            color: white;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        #jump-btn {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            font-size: 1.2rem;
            flex-direction: column;
        }
        
        #jump-btn::before {
            content: "â¬†";
            font-size: 1.8rem;
        }
        
        /* ğŸ”¥ Ø´Ø§Ø´Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ© */
        .end-box {
            background: rgba(0,0,0,0.9);
            padding: 30px;
            border-radius: 20px;
            border: 3px solid #FFD700;
            text-align: center;
            max-width: 400px;
            width: 90%;
        }
        
        .end-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }
        
        /* ğŸ”¥ Ø§Ù„ØªØ¬Ø§ÙˆØ¨ */
        @media (max-height: 500px) {
            .mobile-btn {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
            
            #jump-btn {
                font-size: 1rem;
            }
        }
        
        @media (max-width: 600px) {
            #start-screen h1 {
                font-size: 2rem;
            }
            
            .game-btn {
                padding: 15px;
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <!-- ğŸ”¥ Ø´Ø§Ø´Ø© ØªØ¯ÙˆÙŠØ± Ø§Ù„Ù‡Ø§ØªÙ -->
    <div id="rotate-warning">
        <h1 style="font-size: 3rem; margin-bottom: 20px;">â†»</h1>
        <h2>Ø§Ù„Ù„Ø¹Ø¨Ø© ØªØ¹Ù…Ù„ ÙÙŠ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø£ÙÙ‚ÙŠ</h2>
        <p style="margin-top: 20px; font-size: 1.2rem;">ÙŠØ±Ø¬Ù‰ ØªØ¯ÙˆÙŠØ± Ù‡Ø§ØªÙÙƒ</p>
    </div>

    <!-- ğŸ”¥ Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù„Ø¹Ø¨Ø© -->
    <div id="game-container">
        <!-- Ø²Ø± Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø© -->
        <button id="fullscreen-btn" title="Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©">â›¶</button>
        
        <!-- ğŸ”¥ Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© - SIMPLE -->
        <div id="start-screen" class="screen active">
            <h1>ğŸ® Ù„Ø¹Ø¨Ø© Ù…Ø§Ø±ÙŠÙˆ</h1>
            <p style="margin: 20px 0; text-align: center; color: #aaa;">
                Ù„Ø¹Ø¨Ø© ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠØ© ØªØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ØªÙ
            </p>
            
            <div style="margin: 30px 0; text-align: center;">
                <div style="width: 100px; height: 150px; background: #e74c3c; margin: 0 auto 20px; border-radius: 10px; border: 3px solid #FFD700;"></div>
                <p>Ø´Ø®ØµÙŠØªÙƒ Ø§Ù„Ù…ÙØ¶Ù„Ø©</p>
            </div>
            
            <div class="start-buttons">
                <button id="start-btn" class="game-btn">ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨</button>
                <button id="howto-btn" class="game-btn">â“ ÙƒÙŠÙÙŠØ© Ø§Ù„Ù„Ø¹Ø¨</button>
            </div>
            
            <p style="margin-top: 40px; color: #777; font-size: 0.9rem;">
                Ø§Ø¶ØºØ· â›¶ Ù„Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙØ¶Ù„ ØªØ¬Ø±Ø¨Ø©
            </p>
        </div>
        
        <!-- ğŸ”¥ Ø´Ø§Ø´Ø© Ø§Ù„Ù„Ø¹Ø¨ -->
        <div id="game-screen" class="screen">
            <div class="game-header">
                <div class="stats">
                    <div class="stat">â± <span id="timer">02:00</span></div>
                    <div class="stat">â­ <span id="score">0</span></div>
                    <div class="stat">â¤ï¸ <span id="lives">3</span></div>
                </div>
                <button id="pause-btn" class="game-btn" style="padding: 8px 15px; font-size: 1rem;">â¸</button>
            </div>
            
            <div class="game-area">
                <canvas id="game-canvas"></canvas>
                
                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
                <div class="mobile-controls">
                    <div class="control-group">
                        <button id="left-btn" class="mobile-btn">â†</button>
                        <button id="right-btn" class="mobile-btn">â†’</button>
                    </div>
                    <div class="control-group">
                        <button id="jump-btn" class="mobile-btn">Ù‚ÙØ²</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ğŸ”¥ Ø´Ø§Ø´Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ© -->
        <div id="end-screen" class="screen">
            <div class="end-box">
                <div id="end-icon" class="end-icon">ğŸ†</div>
                <h2 id="end-title" style="color: #FFD700;">ØªÙ‡Ø§Ù†ÙŠÙ†Ø§!</h2>
                <p id="end-message" style="margin: 15px 0;">Ù„Ù‚Ø¯ Ø£ÙƒÙ…Ù„Øª Ø§Ù„Ù…Ø³ØªÙˆÙ‰</p>
                
                <div style="margin: 25px 0;">
                    <p>Ø§Ù„Ù†ØªÙŠØ¬Ø©: <span id="final-score" style="color: #2ecc71;">0</span></p>
                    <p>Ø§Ù„Ø¹Ù…Ù„Ø§Øª: <span id="final-coins" style="color: #FFD700;">0/10</span></p>
                </div>
                
                <div style="display: flex; flex-direction: column; gap: 15px;">
                    <button id="play-again-btn" class="game-btn">ğŸ”„ Ù„Ø¹Ø¨ Ù…Ø¬Ø¯Ø¯Ø§Ù‹</button>
                    <button id="back-to-menu-btn" class="game-btn" style="background: #3498db;">ğŸ  Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ğŸ”¥ SCRIPT ÙˆØ§Ø­Ø¯ ÙƒØ§Ù…Ù„ -->
    <script>
        // ============================================
        // ğŸ® GAME ENGINE - Ø¥ØµØ¯Ø§Ø± Ù…Ø¨Ø³Ø· ÙŠØ¹Ù…Ù„ ÙÙˆØ±Ø§Ù‹
        // ============================================
        
        console.log('ğŸ® ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©...');
        
        class SimpleMarioGame {
            constructor() {
                // ğŸ”¥ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                this.canvas = document.getElementById('game-canvas');
                this.ctx = this.canvas.getContext('2d');
                
                // ğŸ”¥ Ø­Ø¬Ù… Ø§Ù„ÙƒÙ†ÙØ§Ø³
                this.resizeCanvas();
                window.addEventListener('resize', () => this.resizeCanvas());
                
                // ğŸ”¥ Ø­Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
                this.gameState = 'start'; // start, playing, paused, ended
                this.keys = {};
                this.touch = { left: false, right: false, jump: false };
                
                // ğŸ”¥ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                this.score = 0;
                this.lives = 3;
                this.time = 120;
                this.coins = 0;
                this.totalCoins = 5;
                
                // ğŸ”¥ Ø§Ù„Ù„Ø§Ø¹Ø¨
                this.player = {
                    x: 100,
                    y: 300,
                    width: 40,
                    height: 60,
                    speed: 5,
                    velX: 0,
                    velY: 0,
                    jumpPower: -15,
                    grounded: false,
                    canJump: true
                };
                
                // ğŸ”¥ Ø§Ù„Ø¹Ø§Ù„Ù…
                this.platforms = [];
                this.coinItems = [];
                this.createWorld();
                
                // ğŸ”¥ Ø§Ù„Ù…Ø¤Ù‚Øª
                this.gameTimer = null;
                this.lastTime = 0;
                
                // ğŸ”¥ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                this.setupControls();
                this.setupButtons();
                
                console.log('âœ… Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¬Ø§Ù‡Ø²Ø©');
            }
            
            resizeCanvas() {
                const container = document.querySelector('.game-area');
                if (container) {
                    this.canvas.width = container.clientWidth;
                    this.canvas.height = container.clientHeight;
                } else {
                    this.canvas.width = window.innerWidth;
                    this.canvas.height = window.innerHeight * 0.8;
                }
                this.createWorld();
            }
            
            createWorld() {
                // Ø§Ù„Ø£Ø±Ø¶
                this.platforms = [
                    { x: 0, y: this.canvas.height - 50, width: this.canvas.width * 2, height: 50 }
                ];
                
                // Ù…Ù†ØµØ§Øª
                for (let i = 0; i < 3; i++) {
                    this.platforms.push({
                        x: 300 + i * 250,
                        y: 300 + Math.sin(i) * 50,
                        width: 150,
                        height: 20
                    });
                }
                
                // Ø¹Ù…Ù„Ø§Øª
                this.coinItems = [];
                for (let i = 0; i < this.totalCoins; i++) {
                    this.coinItems.push({
                        x: 200 + i * 150,
                        y: 200 + Math.sin(i * 0.5) * 80,
                        collected: false
                    });
                }
            }
            
            setupControls() {
                // Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
                window.addEventListener('keydown', (e) => {
                    this.keys[e.key.toLowerCase()] = true;
                    if (e.key === ' ' && this.gameState === 'playing') this.jump();
                });
                
                window.addEventListener('keyup', (e) => {
                    this.keys[e.key.toLowerCase()] = false;
                });
                
                // Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù„Ù…Ø³
                const setupBtn = (id, control) => {
                    const btn = document.getElementById(id);
                    if (!btn) return;
                    
                    btn.addEventListener('touchstart', (e) => {
                        e.preventDefault();
                        this.touch[control] = true;
                        if (control === 'jump' && this.gameState === 'playing') this.jump();
                    });
                    
                    btn.addEventListener('touchend', (e) => {
                        e.preventDefault();
                        this.touch[control] = false;
                    });
                    
                    // Ù„Ù„Ù…Ø§ÙˆØ³ Ø£ÙŠØ¶Ø§Ù‹
                    btn.addEventListener('mousedown', (e) => {
                        e.preventDefault();
                        this.touch[control] = true;
                        if (control === 'jump' && this.gameState === 'playing') this.jump();
                    });
                    
                    btn.addEventListener('mouseup', (e) => {
                        e.preventDefault();
                        this.touch[control] = false;
                    });
                };
                
                setupBtn('left-btn', 'left');
                setupBtn('right-btn', 'right');
                setupBtn('jump-btn', 'jump');
            }
            
            setupButtons() {
                // ğŸ”¥ Ø²Ø± Ø§Ù„Ø¨Ø¯Ø¡ - Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹
                document.getElementById('start-btn').addEventListener('click', () => {
                    console.log('ğŸš€ Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©');
                    this.startGame();
                });
                
                // Ø²Ø± Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù
                document.getElementById('pause-btn').addEventListener('click', () => {
                    if (this.gameState === 'playing') {
                        this.pauseGame();
                    } else if (this.gameState === 'paused') {
                        this.resumeGame();
                    }
                });
                
                // Ø²Ø± Ø§Ù„Ù„Ø¹Ø¨ Ù…Ø¬Ø¯Ø¯Ø§Ù‹
                document.getElementById('play-again-btn').addEventListener('click', () => {
                    this.startGame();
                });
                
                // Ø²Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
                document.getElementById('back-to-menu-btn').addEventListener('click', () => {
                    this.showScreen('start');
                });
                
                // Ø²Ø± Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª
                document.getElementById('howto-btn').addEventListener('click', () => {
                    alert('ğŸ® ÙƒÙŠÙÙŠØ© Ø§Ù„Ù„Ø¹Ø¨:\n\nâ† â†’ Ù„Ù„Ø­Ø±ÙƒØ©\nSPACE Ø£Ùˆ Ø²Ø± Ø§Ù„Ù‚ÙØ² Ù„Ù„Ù‚ÙØ²\n\nğŸ¯ Ø§Ù„Ù‡Ø¯Ù:\nØ§Ø¬Ù…Ø¹ Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©\n\nâ± Ø§Ù„ÙˆÙ‚Øª: 2 Ø¯Ù‚ÙŠÙ‚Ø©\nâ¤ï¸ Ø§Ù„Ø£Ø±ÙˆØ§Ø­: 3');
                });
                
                // Ø²Ø± Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©
                document.getElementById('fullscreen-btn').addEventListener('click', () => {
                    if (!document.fullscreenElement) {
                        document.documentElement.requestFullscreen().catch(e => {
                            console.log('Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø© ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…');
                        });
                    } else {
                        document.exitFullscreen();
                    }
                });
            }
            
            showScreen(screenName) {
                document.querySelectorAll('.screen').forEach(s => {
                    s.classList.remove('active');
                });
                document.getElementById(`${screenName}-screen`).classList.add('active');
            }
            
            startGame() {
                console.log('ğŸ”¥ Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© ÙØ¹Ù„ÙŠØ§Ù‹');
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„ Ø´ÙŠØ¡
                this.gameState = 'playing';
                this.score = 0;
                this.lives = 3;
                this.time = 120;
                this.coins = 0;
                
                this.player.x = 100;
                this.player.y = 300;
                this.player.velX = 0;
                this.player.velY = 0;
                this.player.grounded = false;
                this.player.canJump = true;
                
                this.createWorld();
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
                this.updateUI();
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ø´Ø§Ø´Ø© Ø§Ù„Ù„Ø¹Ø¨
                this.showScreen('game');
                
                // Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¤Ù‚Øª
                this.startTimer();
                
                // Ø¨Ø¯Ø¡ Ø§Ù„Ø­Ù„Ù‚Ø©
                this.lastTime = performance.now();
                this.gameLoop();
            }
            
            jump() {
                if (this.player.grounded && this.player.canJump && this.gameState === 'playing') {
                    this.player.velY = this.player.jumpPower;
                    this.player.grounded = false;
                    this.player.canJump = false;
                    
                    setTimeout(() => {
                        this.player.canJump = true;
                    }, 300);
                }
            }
            
            startTimer() {
                clearInterval(this.gameTimer);
                this.gameTimer = setInterval(() => {
                    if (this.gameState === 'playing') {
                        this.time--;
                        this.updateUI();
                        
                        if (this.time <= 0) {
                            this.endGame(false);
                        }
                    }
                }, 1000);
            }
            
            updatePlayer(deltaTime) {
                if (this.gameState !== 'playing') return;
                
                // Ø­Ø±ÙƒØ©
                this.player.velX = 0;
                if (this.keys['arrowleft'] || this.keys['a'] || this.touch.left) {
                    this.player.velX = -this.player.speed;
                }
                if (this.keys['arrowright'] || this.keys['d'] || this.touch.right) {
                    this.player.velX = this.player.speed;
                }
                
                // Ø¬Ø§Ø°Ø¨ÙŠØ©
                this.player.velY += 0.8;
                if (this.player.velY > 20) this.player.velY = 20;
                
                // Ø­Ø±ÙƒØ©
                this.player.x += this.player.velX * deltaTime * 60;
                this.player.y += this.player.velY * deltaTime * 60;
                
                // Ø­Ø¯ÙˆØ¯
                if (this.player.x < 0) this.player.x = 0;
                if (this.player.x > this.canvas.width - this.player.width) {
                    this.player.x = this.canvas.width - this.player.width;
                }
                
                // ØªØµØ§Ø¯Ù… Ù…Ø¹ Ø§Ù„Ù…Ù†ØµØ§Øª
                this.player.grounded = false;
                for (const platform of this.platforms) {
                    if (this.player.x < platform.x + platform.width &&
                        this.player.x + this.player.width > platform.x &&
                        this.player.y + this.player.height > platform.y &&
                        this.player.y + this.player.height < platform.y + platform.height + this.player.velY &&
                        this.player.velY > 0) {
                        
                        this.player.y = platform.y - this.player.height;
                        this.player.velY = 0;
                        this.player.grounded = true;
                    }
                }
                
                // Ø³Ù‚ÙˆØ·
                if (this.player.y > this.canvas.height) {
                    this.lives--;
                    this.updateUI();
                    
                    if (this.lives <= 0) {
                        this.endGame(false);
                    } else {
                        this.player.x = 100;
                        this.player.y = 300;
                        this.player.velY = 0;
                    }
                }
            }
            
            updateCoins() {
                for (let coin of this.coinItems) {
                    if (!coin.collected) {
                        const dx = this.player.x + this.player.width/2 - coin.x;
                        const dy = this.player.y + this.player.height/2 - coin.y;
                        const dist = Math.sqrt(dx*dx + dy*dy);
                        
                        if (dist < 30) {
                            coin.collected = true;
                            this.coins++;
                            this.score += 100;
                            this.updateUI();
                            
                            if (this.coins >= this.totalCoins) {
                                this.endGame(true);
                            }
                        }
                    }
                }
            }
            
            gameLoop(currentTime = 0) {
                if (this.gameState !== 'playing') return;
                
                const deltaTime = (currentTime - this.lastTime) / 1000;
                this.lastTime = currentTime;
                
                this.updatePlayer(deltaTime);
                this.updateCoins();
                this.draw();
                
                requestAnimationFrame((time) => this.gameLoop(time));
            }
            
            draw() {
                // Ø®Ù„ÙÙŠØ©
                this.ctx.fillStyle = '#87CEEB';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                
                // Ù…Ù†ØµØ§Øª
                this.ctx.fillStyle = '#8B4513';
                this.platforms.forEach(p => {
                    this.ctx.fillRect(p.x, p.y, p.width, p.height);
                });
                
                // Ø¹Ù…Ù„Ø§Øª
                this.coinItems.forEach(coin => {
                    if (!coin.collected) {
                        this.ctx.fillStyle = '#FFD700';
                        this.ctx.beginPath();
                        this.ctx.arc(coin.x, coin.y, 12, 0, Math.PI * 2);
                        this.ctx.fill();
                        
                        this.ctx.fillStyle = '#FFA500';
                        this.ctx.beginPath();
                        this.ctx.arc(coin.x, coin.y, 8, 0, Math.PI * 2);
                        this.ctx.fill();
                    }
                });
                
                // Ù„Ø§Ø¹Ø¨
                this.ctx.fillStyle = '#E74C3C';
                this.ctx.fillRect(this.player.x, this.player.y, this.player.width, this.player.height);
                
                // Ø¹ÙŠÙˆÙ†
                this.ctx.fillStyle = '#2C3E50';
                this.ctx.fillRect(this.player.x + 10, this.player.y + 10, 20, 20);
                
                this.ctx.fillStyle = '#FFF';
                this.ctx.fillRect(this.player.x + 15, this.player.y + 15, 5, 5);
                this.ctx.fillRect(this.player.x + 25, this.player.y + 15, 5, 5);
                
                // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
                this.ctx.fillStyle = 'rgba(0,0,0,0.5)';
                this.ctx.fillRect(10, 10, 200, 60);
                this.ctx.fillStyle = '#FFF';
                this.ctx.font = '14px Arial';
                this.ctx.fillText(`Ø§Ù„Ù…ÙˆÙ‚Ø¹: (${Math.floor(this.player.x)},${Math.floor(this.player.y)})`, 20, 30);
                this.ctx.fillText(`Ø§Ù„Ø³Ø±Ø¹Ø©: (${this.player.velX.toFixed(1)},${this.player.velY.toFixed(1)})`, 20, 50);
                this.ctx.fillText(`Ø§Ù„Ø­Ø§Ù„Ø©: ${this.gameState}`, 20, 70);
            }
            
            pauseGame() {
                this.gameState = 'paused';
                clearInterval(this.gameTimer);
                document.getElementById('pause-btn').textContent = 'â–¶';
            }
            
            resumeGame() {
                this.gameState = 'playing';
                this.startTimer();
                document.getElementById('pause-btn').textContent = 'â¸';
                this.lastTime = performance.now();
                this.gameLoop();
            }
            
            endGame(isWin) {
                this.gameState = 'ended';
                clearInterval(this.gameTimer);
                
                document.getElementById('end-icon').textContent = isWin ? 'ğŸ†' : 'ğŸ’€';
                document.getElementById('end-title').textContent = isWin ? 'ØªÙ‡Ø§Ù†ÙŠÙ†Ø§!' : 'Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©';
                document.getElementById('end-message').textContent = isWin ? 
                    `Ø¬Ù…Ø¹Øª ${this.coins} Ø¹Ù…Ù„Ø©!` : 'Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰';
                
                document.getElementById('final-score').textContent = this.score;
                document.getElementById('final-coins').textContent = `${this.coins}/${this.totalCoins}`;
                
                this.showScreen('end');
            }
            
            updateUI() {
                document.getElementById('timer').textContent = this.formatTime(this.time);
                document.getElementById('score').textContent = this.score;
                document.getElementById('lives').textContent = this.lives;
            }
            
            formatTime(seconds) {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            }
        }
        
        // ============================================
        // ğŸ”¥ Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        // ============================================
        
        window.addEventListener('load', () => {
            console.log('ğŸ“„ Ø§Ù„ØµÙØ­Ø© Ù…Ø­Ù…Ù„Ø© - Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©...');
            
            // Ø¥Ø®ÙØ§Ø¡ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¯ÙˆØ±Ø§Ù† Ø¥Ø°Ø§ ÙƒØ§Ù† Ø£ÙÙ‚ÙŠ
            if (window.innerHeight <= window.innerWidth) {
                document.getElementById('rotate-warning').style.display = 'none';
            }
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© Ù…Ø¨Ø§Ø´Ø±Ø©
            window.game = new SimpleMarioGame();
            console.log('âœ… Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¬Ø§Ù‡Ø²Ø©! Ø§Ø¶ØºØ· Ø²Ø± "ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨"');
            
            // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø²Ø±
            const startBtn = document.getElementById('start-btn');
            startBtn.addEventListener('click', () => {
                console.log('ğŸ® ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¨Ø¯Ø¡!');
            });
            
            // ØªØ«Ø¨ÙŠØª Ø§Ù„Ø¯ÙˆØ±Ø§Ù† Ù„Ù„Ù‡Ø§ØªÙ
            if (screen.orientation && screen.orientation.lock) {
                screen.orientation.lock('landscape').catch(() => {
                    console.log('Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ«Ø¨ÙŠØª Ø§Ù„Ø¯ÙˆØ±Ø§Ù†');
                });
            }
        });
        
        // ØªØ­Ø¯ÙŠØ« Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¯ÙˆØ±Ø§Ù† Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø¬Ù…
        window.addEventListener('resize', () => {
            const warning = document.getElementById('rotate-warning');
            if (window.innerHeight > window.innerWidth) {
                warning.style.display = 'flex';
            } else {
                warning.style.display = 'none';
            }
        });
        
        // Ù…Ù†Ø¹ Ø§Ù„Ø³Ù„ÙˆÙƒ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
        document.addEventListener('contextmenu', e => e.preventDefault());
    </script>
</body>
</html>
