<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Ù„Ø¹Ø¨Ø© Ù…Ø§Ø±ÙŠÙˆ - ØªØ¹Ù…Ù„ 100%</title>
    <style>
        /* RESET */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }
        
        body, html {
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            position: fixed;
            background: #000;
            color: white;
            font-family: Arial, sans-serif;
        }
        
        /* Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠ */
        #rotate-warning {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: #000;
            color: #FFD700;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            z-index: 9999;
            padding: 20px;
        }
        
        @media (orientation: portrait) {
            #rotate-warning { display: flex; }
            #game-container { display: none !important; }
        }
        
        /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù„Ø¹Ø¨Ø© */
        #game-container {
            width: 100vw;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            background: #000;
            display: flex;
            flex-direction: column;
        }
        
        /* Ø²Ø± Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø© */
        #fullscreen-btn {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 40px;
            height: 40px;
            background: rgba(0,0,0,0.7);
            border: 2px solid #FFD700;
            color: #FFD700;
            border-radius: 50%;
            font-size: 1.2rem;
            z-index: 1000;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Ø§Ù„Ø´Ø§Ø´Ø§Øª */
        .screen {
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
        }
        
        .screen.active {
            display: flex;
        }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© */
        #start-screen h1 {
            color: #FFD700;
            font-size: 2.5rem;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .start-buttons {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 100%;
            max-width: 300px;
            margin-top: 40px;
        }
        
        .game-btn {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
            border: none;
            padding: 20px;
            font-size: 1.3rem;
            font-weight: bold;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .game-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(46, 204, 113, 0.4);
        }
        
        #howto-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„Ù„Ø¹Ø¨ */
        #game-screen {
            padding: 0;
            background: #000;
        }
        
        .game-header {
            width: 100%;
            background: rgba(0,0,0,0.8);
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 3px solid #FFD700;
        }
        
        .stats {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .stat {
            background: rgba(255,255,255,0.1);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 1rem;
            min-width: 80px;
            text-align: center;
        }
        
        .game-area {
            flex: 1;
            position: relative;
            width: 100%;
            overflow: hidden;
        }
        
        #game-canvas {
            width: 100%;
            height: 100%;
            display: block;
            background: #87CEEB;
        }
        
        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ù„Ù„Ù‡Ø§ØªÙ */
        .mobile-controls {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 100;
        }
        
        .control-group {
            display: flex;
            gap: 20px;
        }
        
        .mobile-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: rgba(0,0,0,0.7);
            border: 3px solid #FFD700;
            color: white;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        #jump-btn {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            font-size: 1.2rem;
            flex-direction: column;
        }
        
        #jump-btn::before {
            content: "â¬†";
            font-size: 1.8rem;
        }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ© */
        .end-box {
            background: rgba(0,0,0,0.9);
            padding: 30px;
            border-radius: 20px;
            border: 3px solid #FFD700;
            text-align: center;
            max-width: 400px;
            width: 90%;
        }
        
        .end-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }
        
        /* Ø§Ù„ØªØ¬Ø§ÙˆØ¨ */
        @media (max-height: 500px) {
            .mobile-btn {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
            
            #jump-btn {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Ø´Ø§Ø´Ø© ØªØ¯ÙˆÙŠØ± Ø§Ù„Ù‡Ø§ØªÙ -->
    <div id="rotate-warning">
        <h1 style="font-size: 3rem; margin-bottom: 20px;">â†»</h1>
        <h2>Ø§Ù„Ù„Ø¹Ø¨Ø© ØªØ¹Ù…Ù„ ÙÙŠ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø£ÙÙ‚ÙŠ</h2>
        <p style="margin-top: 20px; font-size: 1.2rem;">ÙŠØ±Ø¬Ù‰ ØªØ¯ÙˆÙŠØ± Ù‡Ø§ØªÙÙƒ</p>
    </div>

    <!-- Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù„Ø¹Ø¨Ø© -->
    <div id="game-container">
        <!-- Ø²Ø± Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø© -->
        <button id="fullscreen-btn" title="Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©">â›¶</button>
        
        <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© -->
        <div id="start-screen" class="screen active">
            <h1>ğŸ® Ù„Ø¹Ø¨Ø© Ù…Ø§Ø±ÙŠÙˆ</h1>
            <p style="margin: 20px 0; text-align: center; color: #aaa;">
                Ø¬Ù…Ø¹ Ø§Ù„Ø¹Ù…Ù„Ø§Øª ÙˆØªØ¬Ù†Ø¨ Ø§Ù„Ø³Ù‚ÙˆØ·
            </p>
            
            <div style="margin: 30px 0; text-align: center;">
                <div style="width: 100px; height: 150px; background: #e74c3c; margin: 0 auto 20px; border-radius: 10px; border: 3px solid #FFD700;"></div>
                <p>Ø´Ø®ØµÙŠØªÙƒ Ø§Ù„Ù…ÙØ¶Ù„Ø©</p>
            </div>
            
            <div class="start-buttons">
                <button id="start-btn" class="game-btn">ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨</button>
                <button id="howto-btn" class="game-btn">â“ ÙƒÙŠÙÙŠØ© Ø§Ù„Ù„Ø¹Ø¨</button>
            </div>
            
            <p style="margin-top: 40px; color: #777; font-size: 0.9rem;">
                Ø§Ù„ÙˆÙ‚Øª: 2 Ø¯Ù‚ÙŠÙ‚Ø© | Ø§Ù„Ø£Ø±ÙˆØ§Ø­: 3 | Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©: 5
            </p>
        </div>
        
        <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ù„Ø¹Ø¨ -->
        <div id="game-screen" class="screen">
            <div class="game-header">
                <div class="stats">
                    <div class="stat">â± <span id="timer">02:00</span></div>
                    <div class="stat">â­ <span id="score">0</span></div>
                    <div class="stat">â¤ï¸ <span id="lives">3</span></div>
                    <div class="stat">ğŸŸ¡ <span id="coins">0/5</span></div>
                </div>
                <button id="pause-btn" class="game-btn" style="padding: 8px 15px; font-size: 1rem;">â¸</button>
            </div>
            
            <div class="game-area">
                <canvas id="game-canvas"></canvas>
                
                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
                <div class="mobile-controls">
                    <div class="control-group">
                        <button id="left-btn" class="mobile-btn">â†</button>
                        <button id="right-btn" class="mobile-btn">â†’</button>
                    </div>
                    <div class="control-group">
                        <button id="jump-btn" class="mobile-btn">Ù‚ÙØ²</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ© -->
        <div id="end-screen" class="screen">
            <div class="end-box">
                <div id="end-icon" class="end-icon">ğŸ†</div>
                <h2 id="end-title" style="color: #FFD700;">ØªÙ‡Ø§Ù†ÙŠÙ†Ø§!</h2>
                <p id="end-message" style="margin: 15px 0;">Ø¬Ù…Ø¹Øª ÙƒÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Øª</p>
                
                <div style="margin: 25px 0;">
                    <p style="margin: 10px 0;">Ø§Ù„Ù†ØªÙŠØ¬Ø©: <span id="final-score" style="color: #2ecc71; font-size: 1.5rem;">0</span></p>
                    <p style="margin: 10px 0;">Ø§Ù„Ø¹Ù…Ù„Ø§Øª: <span id="final-coins" style="color: #FFD700; font-size: 1.5rem;">0/5</span></p>
                    <p style="margin: 10px 0;">Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: <span id="final-time" style="color: #3498db; font-size: 1.5rem;">00:00</span></p>
                </div>
                
                <div style="display: flex; flex-direction: column; gap: 15px;">
                    <button id="play-again-btn" class="game-btn">ğŸ”„ Ù„Ø¹Ø¨ Ù…Ø¬Ø¯Ø¯Ø§Ù‹</button>
                    <button id="back-to-menu-btn" class="game-btn" style="background: #3498db;">ğŸ  Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
                </div>
            </div>
        </div>
    </div>

    <!-- SCRIPT Ø§Ù„ÙƒØ§Ù…Ù„ -->
    <script>
        // ============================================
        // ğŸ® GAME ENGINE - Ø¨Ø¯ÙˆÙ† Ù…Ø´Ø§ÙƒÙ„ ÙˆÙ‚Øª
        // ============================================
        
        console.log('ğŸ® ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©...');
        
        class MarioGame {
            constructor() {
                console.log('ğŸ”§ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©');
                
                // ğŸ”¥ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                this.canvas = document.getElementById('game-canvas');
                this.ctx = this.canvas.getContext('2d');
                
                // ğŸ”¥ Ø­Ø¬Ù… Ø§Ù„ÙƒÙ†ÙØ§Ø³
                this.resizeCanvas();
                window.addEventListener('resize', () => this.resizeCanvas());
                
                // ğŸ”¥ Ø­Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© - Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹
                this.gameState = 'start'; // start, playing, paused, ended
                this.keys = {};
                this.touch = { left: false, right: false, jump: false };
                
                // ğŸ”¥ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª - ØªÙ‡ÙŠØ¦Ø© ØµØ­ÙŠØ­Ø©
                this.score = 0;
                this.lives = 3;
                this.timeLeft = 120; // ğŸ”¥ 2 Ø¯Ù‚ÙŠÙ‚Ø© = 120 Ø«Ø§Ù†ÙŠØ©
                this.coins = 0;
                this.totalCoins = 5;
                
                // ğŸ”¥ Ø§Ù„Ù…Ø¤Ù‚ØªØ§Øª
                this.gameTimer = null;
                this.lastTime = 0;
                this.gameStartTime = 0;
                
                // ğŸ”¥ Ø§Ù„Ø¹Ù†Ø§ØµØ±
                this.player = null;
                this.platforms = [];
                this.coinItems = [];
                this.enemies = [];
                
                // ğŸ”¥ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ø§Ù„Ù…
                this.createGameWorld();
                
                // ğŸ”¥ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                this.setupControls();
                this.setupButtons();
                
                // ğŸ”¥ ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£ÙˆÙ„ÙŠ
                this.updateUI();
                
                console.log('âœ… Ø§Ù„Ù„Ø¹Ø¨Ø© Ù…Ù‡ÙŠØ£Ø© - Ø§Ù„ÙˆÙ‚Øª:', this.timeLeft, 'Ø«Ø§Ù†ÙŠØ©');
            }
            
            resizeCanvas() {
                const container = document.querySelector('.game-area');
                if (container) {
                    this.canvas.width = container.clientWidth;
                    this.canvas.height = container.clientHeight;
                } else {
                    this.canvas.width = window.innerWidth;
                    this.canvas.height = window.innerHeight * 0.8;
                }
                console.log(`ğŸ“ Ø­Ø¬Ù… Ø§Ù„ÙƒÙ†ÙØ§Ø³: ${this.canvas.width}x${this.canvas.height}`);
                this.createGameWorld();
            }
            
            createGameWorld() {
                console.log('ğŸŒ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯');
                
                // ğŸ”¥ Ø§Ù„Ù„Ø§Ø¹Ø¨
                this.player = {
                    x: 100,
                    y: 300,
                    width: 40,
                    height: 60,
                    speed: 6,
                    velX: 0,
                    velY: 0,
                    jumpPower: -16,
                    grounded: false,
                    canJump: true,
                    facingRight: true
                };
                
                // ğŸ”¥ Ø§Ù„Ø£Ø±Ø¶ ÙˆØ§Ù„Ù…Ù†ØµØ§Øª
                this.platforms = [
                    // Ø§Ù„Ø£Ø±Ø¶ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                    { x: 0, y: this.canvas.height - 50, width: this.canvas.width * 2, height: 50, type: 'ground' }
                ];
                
                // ğŸ”¥ Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØµØ§Øª
                const platformCount = Math.min(6, Math.floor(this.canvas.width / 150));
                for (let i = 0; i < platformCount; i++) {
                    this.platforms.push({
                        x: 250 + i * 200,
                        y: 300 + Math.sin(i) * 70,
                        width: 150,
                        height: 20,
                        type: 'platform'
                    });
                }
                
                // ğŸ”¥ Ø§Ù„Ø¹Ù…Ù„Ø§Øª
                this.coinItems = [];
                for (let i = 0; i < this.totalCoins; i++) {
                    this.coinItems.push({
                        x: 180 + i * 160,
                        y: 180 + Math.sin(i * 0.7) * 90,
                        collected: false,
                        anim: 0,
                        id: i
                    });
                }
                
                // ğŸ”¥ Ø£Ø¹Ø¯Ø§Ø¡ (Ù‚Ù„ÙŠÙ„ÙŠÙ† ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©)
                this.enemies = [
                    { x: 450, y: this.platforms[0].y - 40, width: 40, height: 40, dir: 1, speed: 2, active: true },
                    { x: 750, y: this.platforms[0].y - 40, width: 40, height: 40, dir: -1, speed: 2.5, active: true }
                ];
                
                console.log(`ğŸ¯ Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${this.platforms.length} Ù…Ù†ØµØ©ØŒ ${this.coinItems.length} Ø¹Ù…Ù„Ø©`);
            }
            
            setupControls() {
                console.log('ğŸ® ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ­ÙƒÙ…');
                
                // ğŸ”¥ Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
                window.addEventListener('keydown', (e) => {
                    const key = e.key.toLowerCase();
                    this.keys[key] = true;
                    
                    // Ù…Ù†Ø¹ Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¨Ø§Ù„Ù…ÙØ§ØªÙŠØ­
                    if ([' ', 'arrowup', 'arrowdown', 'arrowleft', 'arrowright'].includes(key)) {
                        e.preventDefault();
                    }
                    
                    // Ø§Ù„Ù‚ÙØ²
                    if (key === ' ' && this.gameState === 'playing') {
                        this.jump();
                    }
                });
                
                window.addEventListener('keyup', (e) => {
                    this.keys[e.key.toLowerCase()] = false;
                });
                
                // ğŸ”¥ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù„Ù…Ø³
                const setupTouchButton = (id, control) => {
                    const btn = document.getElementById(id);
                    if (!btn) {
                        console.warn(`âŒ Ø²Ø± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: ${id}`);
                        return;
                    }
                    
                    const handleStart = (e) => {
                        e.preventDefault();
                        this.touch[control] = true;
                        
                        if (control === 'jump' && this.gameState === 'playing') {
                            this.jump();
                        }
                    };
                    
                    const handleEnd = (e) => {
                        e.preventDefault();
                        this.touch[control] = false;
                    };
                    
                    // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù„Ù…Ø³
                    btn.addEventListener('touchstart', handleStart);
                    btn.addEventListener('touchend', handleEnd);
                    btn.addEventListener('touchcancel', handleEnd);
                    
                    // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù…Ø§ÙˆØ³
                    btn.addEventListener('mousedown', handleStart);
                    btn.addEventListener('mouseup', handleEnd);
                    btn.addEventListener('mouseleave', handleEnd);
                    
                    console.log(`âœ… Ø²Ø± ${id} Ø¬Ø§Ù‡Ø²`);
                };
                
                setupTouchButton('left-btn', 'left');
                setupTouchButton('right-btn', 'right');
                setupTouchButton('jump-btn', 'jump');
            }
            
            setupButtons() {
                console.log('ğŸ”˜ ØªÙ‡ÙŠØ¦Ø© Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©');
                
                // ğŸ”¥ Ø²Ø± Ø§Ù„Ø¨Ø¯Ø¡ - Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹
                const startBtn = document.getElementById('start-btn');
                if (startBtn) {
                    startBtn.addEventListener('click', () => {
                        console.log('ğŸš€ ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¨Ø¯Ø¡');
                        this.startGame();
                    });
                    console.log('âœ… Ø²Ø± Ø§Ù„Ø¨Ø¯Ø¡ Ø¬Ø§Ù‡Ø²');
                } else {
                    console.error('âŒ Ø²Ø± Ø§Ù„Ø¨Ø¯Ø¡ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯!');
                }
                
                // ğŸ”¥ Ø²Ø± Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¤Ù‚Øª
                document.getElementById('pause-btn').addEventListener('click', () => {
                    if (this.gameState === 'playing') {
                        this.pauseGame();
                    } else if (this.gameState === 'paused') {
                        this.resumeGame();
                    }
                });
                
                // ğŸ”¥ Ø²Ø± Ø§Ù„Ù„Ø¹Ø¨ Ù…Ø¬Ø¯Ø¯Ø§Ù‹
                document.getElementById('play-again-btn').addEventListener('click', () => {
                    console.log('ğŸ”„ Ø·Ù„Ø¨ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨');
                    this.startGame();
                });
                
                // ğŸ”¥ Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©
                document.getElementById('back-to-menu-btn').addEventListener('click', () => {
                    this.showScreen('start');
                });
                
                // ğŸ”¥ Ø²Ø± Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª
                document.getElementById('howto-btn').addEventListener('click', () => {
                    alert(`ğŸ® ÙƒÙŠÙÙŠØ© Ø§Ù„Ù„Ø¹Ø¨:\n\nâ¬…ï¸â¡ï¸ Ù„Ù„Ø­Ø±ÙƒØ© ÙŠÙ…ÙŠÙ†/ÙŠØ³Ø§Ø±\nâ¬†ï¸ SPACE Ù„Ù„Ù‚ÙØ²\n\nğŸ¯ Ø§Ù„Ù‡Ø¯Ù:\nâ€¢ Ø§Ø¬Ù…Ø¹ ${this.totalCoins} Ø¹Ù…Ù„Ø© Ø°Ù‡Ø¨ÙŠØ© ğŸŸ¡\nâ€¢ ØªØ¬Ù†Ø¨ Ø§Ù„Ø³Ù‚ÙˆØ· Ù…Ù† Ø§Ù„Ù…Ù†ØµØ§Øª\nâ€¢ Ù„Ø¯ÙŠÙƒ 2 Ø¯Ù‚ÙŠÙ‚Ø© â±ï¸ Ùˆ 3 Ø£Ø±ÙˆØ§Ø­ â¤ï¸\n\nğŸ•¹ï¸ Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ØªÙ:\nØ§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¸Ø§Ù‡Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø©`);
                });
                
                // ğŸ”¥ Ø²Ø± Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©
                document.getElementById('fullscreen-btn').addEventListener('click', () => {
                    if (!document.fullscreenElement) {
                        document.documentElement.requestFullscreen().catch(e => {
                            console.log('Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø© ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…:', e);
                        });
                    } else {
                        document.exitFullscreen();
                    }
                });
            }
            
            showScreen(screenName) {
                console.log(`ğŸ“º Ø¥Ø¸Ù‡Ø§Ø± Ø´Ø§Ø´Ø©: ${screenName}`);
                
                // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ø§Ø´Ø§Øª
                document.querySelectorAll('.screen').forEach(s => {
                    s.classList.remove('active');
                });
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
                const screen = document.getElementById(`${screenName}-screen`);
                if (screen) {
                    screen.classList.add('active');
                } else {
                    console.error(`âŒ Ø´Ø§Ø´Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©: ${screenName}`);
                }
            }
            
            startGame() {
                console.log('ğŸ¯ ===== Ø¨Ø¯Ø¡ Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø© =====');
                
                // ğŸ”¥ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„ Ø´ÙŠØ¡
                this.gameState = 'playing';
                this.score = 0;
                this.lives = 3;
                this.timeLeft = 120; // ğŸ”¥ 2 Ø¯Ù‚ÙŠÙ‚Ø© ÙƒØ§Ù…Ù„Ø©
                this.coins = 0;
                
                // ğŸ”¥ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù„Ø§Ø¹Ø¨
                this.player.x = 100;
                this.player.y = 300;
                this.player.velX = 0;
                this.player.velY = 0;
                this.player.grounded = false;
                this.player.canJump = true;
                
                // ğŸ”¥ Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ø§Ù„Ù…
                this.createGameWorld();
                
                // ğŸ”¥ ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
                this.updateUI();
                
                // ğŸ”¥ Ø¥Ø¸Ù‡Ø§Ø± Ø´Ø§Ø´Ø© Ø§Ù„Ù„Ø¹Ø¨
                this.showScreen('game');
                
                // ğŸ”¥ Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¤Ù‚Øª - Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹
                this.startTimer();
                
                // ğŸ”¥ Ø¨Ø¯Ø¡ Ø§Ù„Ø­Ù„Ù‚Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                this.lastTime = performance.now();
                this.gameStartTime = Date.now();
                this.gameLoop();
                
                console.log(`âœ… Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¨Ø¯Ø£Øª - Ø§Ù„ÙˆÙ‚Øª: ${this.timeLeft}Ø«ØŒ Ø§Ù„Ø£Ø±ÙˆØ§Ø­: ${this.lives}`);
                console.log(`ğŸ¯ Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©: ${this.totalCoins}`);
            }
            
            jump() {
                if (this.player.grounded && this.player.canJump && this.gameState === 'playing') {
                    console.log('â¬†ï¸ Ø§Ù„Ù‚ÙØ²!');
                    this.player.velY = this.player.jumpPower;
                    this.player.grounded = false;
                    this.player.canJump = false;
                    
                    setTimeout(() => {
                        this.player.canJump = true;
                    }, 300);
                }
            }
            
            startTimer() {
                console.log('â±ï¸ Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¤Ù‚Øª');
                
                // ğŸ”¥ Ø¥ÙŠÙ‚Ø§Ù Ø£ÙŠ Ù…Ø¤Ù‚Øª Ø³Ø§Ø¨Ù‚
                if (this.gameTimer) {
                    clearInterval(this.gameTimer);
                    this.gameTimer = null;
                }
                
                // ğŸ”¥ Ø¨Ø¯Ø¡ Ù…Ø¤Ù‚Øª Ø¬Ø¯ÙŠØ¯
                this.gameTimer = setInterval(() => {
                    if (this.gameState === 'playing') {
                        this.timeLeft--;
                        this.updateUI();
                        
                        console.log(`â±ï¸ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${this.timeLeft}Ø«`);
                        
                        // ğŸ”¥ ÙØ­Øµ Ø¥Ø°Ø§ Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª
                        if (this.timeLeft <= 0) {
                            console.log('â° Ø§Ù„ÙˆÙ‚Øª Ø§Ù†ØªÙ‡Ù‰!');
                            this.endGame(false, 'time');
                        }
                    }
                }, 1000); // ğŸ”¥ ÙƒÙ„ Ø«Ø§Ù†ÙŠØ©
            }
            
            updatePlayer(deltaTime) {
                if (this.gameState !== 'playing') return;
                
                // ğŸ”¥ Ø§Ù„Ø­Ø±ÙƒØ©
                this.player.velX = 0;
                
                if (this.keys['arrowleft'] || this.keys['a'] || this.touch.left) {
                    this.player.velX = -this.player.speed;
                    this.player.facingRight = false;
                }
                
                if (this.keys['arrowright'] || this.keys['d'] || this.touch.right) {
                    this.player.velX = this.player.speed;
                    this.player.facingRight = true;
                }
                
                // ğŸ”¥ Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ©
                this.player.velY += 0.8;
                if (this.player.velY > 20) this.player.velY = 20;
                
                // ğŸ”¥ Ø§Ù„Ø­Ø±ÙƒØ©
                this.player.x += this.player.velX * deltaTime * 60;
                this.player.y += this.player.velY * deltaTime * 60;
                
                // ğŸ”¥ Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø´Ø§Ø´Ø© (ÙŠØ³Ø§Ø±)
                if (this.player.x < 0) {
                    this.player.x = 0;
                }
                
                // ğŸ”¥ Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø´Ø§Ø´Ø© (ÙŠÙ…ÙŠÙ†)
                const maxX = this.canvas.width * 2 - this.player.width;
                if (this.player.x > maxX) {
                    this.player.x = maxX;
                }
                
                // ğŸ”¥ ÙØ­Øµ Ø§Ù„Ø§ØµØ·Ø¯Ø§Ù… Ù…Ø¹ Ø§Ù„Ù…Ù†ØµØ§Øª
                this.player.grounded = false;
                
                for (const platform of this.platforms) {
                    const collision = 
                        this.player.x < platform.x + platform.width &&
                        this.player.x + this.player.width > platform.x &&
                        this.player.y + this.player.height > platform.y &&
                        this.player.y + this.player.height < platform.y + platform.height + this.player.velY &&
                        this.player.velY > 0;
                    
                    if (collision) {
                        this.player.y = platform.y - this.player.height;
                        this.player.velY = 0;
                        this.player.grounded = true;
                        break;
                    }
                }
                
                // ğŸ”¥ ÙØ­Øµ Ø§Ù„Ø³Ù‚ÙˆØ·
                if (this.player.y > this.canvas.height + 100) {
                    console.log('ğŸ’€ Ø³Ù‚ÙˆØ·!');
                    this.lives--;
                    this.updateUI();
                    
                    if (this.lives <= 0) {
                        this.endGame(false, 'lives');
                    } else {
                        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù„Ø§Ø¹Ø¨
                        this.player.x = 100;
                        this.player.y = 300;
                        this.player.velY = 0;
                        this.player.grounded = false;
                        
                        console.log(`â¤ï¸ Ø£Ø±ÙˆØ§Ø­ Ù…ØªØ¨Ù‚ÙŠØ©: ${this.lives}`);
                    }
                }
            }
            
            updateCoins(deltaTime) {
                for (let coin of this.coinItems) {
                    if (!coin.collected) {
                        // Ø­Ø±ÙƒØ© Ø·ÙÙŠÙØ© Ù„Ù„Ø¹Ù…Ù„Ø§Øª
                        coin.anim += deltaTime * 5;
                        
                        // ğŸ”¥ ÙØ­Øµ Ø§Ù„Ø¬Ù…Ø¹
                        const dx = this.player.x + this.player.width/2 - coin.x;
                        const dy = this.player.y + this.player.height/2 - coin.y;
                        const distance = Math.sqrt(dx*dx + dy*dy);
                        
                        if (distance < 30) {
                            console.log(`ğŸ’° Ø¬Ù…Ø¹ Ø¹Ù…Ù„Ø© ${coin.id + 1}!`);
                            coin.collected = true;
                            this.coins++;
                            this.score += 100;
                            this.updateUI();
                            
                            // ğŸ”¥ ÙØ­Øµ Ø¥Ø°Ø§ Ø¬Ù…Ø¹ ÙƒÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Øª
                            if (this.coins >= this.totalCoins) {
                                console.log('ğŸ† Ø¬Ù…Ø¹Øª ÙƒÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Øª!');
                                this.endGame(true, 'coins');
                            }
                        }
                    }
                }
            }
            
            updateEnemies(deltaTime) {
                for (let enemy of this.enemies) {
                    if (!enemy.active) continue;
                    
                    // Ø­Ø±ÙƒØ© Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡
                    enemy.x += enemy.speed * enemy.dir * deltaTime * 60;
                    
                    // ØªØºÙŠÙŠØ± Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø¹Ù†Ø¯ Ø§Ù„Ø­ÙˆØ§Ù
                    if (enemy.x < 0 || enemy.x + enemy.width > this.canvas.width * 2) {
                        enemy.dir *= -1;
                    }
                    
                    // ÙˆØ¶Ø¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø±Ø¶
                    enemy.y = this.platforms[0].y - enemy.height;
                    
                    // ğŸ”¥ ÙØ­Øµ Ø§Ù„Ø§ØµØ·Ø¯Ø§Ù… Ù…Ø¹ Ø§Ù„Ù„Ø§Ø¹Ø¨
                    if (this.player.x < enemy.x + enemy.width &&
                        this.player.x + this.player.width > enemy.x &&
                        this.player.y < enemy.y + enemy.height &&
                        this.player.y + this.player.height > enemy.y) {
                        
                        // Ø¥Ø°Ø§ ÙˆØ·Ø£ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø¯Ùˆ Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰
                        if (this.player.velY > 0 && this.player.y + this.player.height < enemy.y + enemy.height/2) {
                            console.log('ğŸ‘¾ Ù‡Ø²Ù…Øª Ø¹Ø¯ÙˆØ§Ù‹!');
                            enemy.active = false;
                            enemy.x = -1000; // Ø¥Ø²Ø§Ù„ØªÙ‡
                            this.score += 200;
                            this.updateUI();
                        } else {
                            // ØªØ¶Ø±Ø± Ø§Ù„Ù„Ø§Ø¹Ø¨
                            console.log('ğŸ’¥ ØªØ¶Ø±Ø± Ù…Ù† Ø¹Ø¯Ùˆ!');
                            this.lives--;
                            this.updateUI();
                            
                            if (this.lives <= 0) {
                                this.endGame(false, 'enemy');
                            } else {
                                // Ø§Ø±ØªØ¯Ø§Ø¯ Ø¹Ù†Ø¯ Ø§Ù„Ø¶Ø±Ø±
                                this.player.velY = -10;
                                this.player.velX = this.player.facingRight ? -10 : 10;
                            }
                        }
                    }
                }
            }
            
            gameLoop(currentTime = 0) {
                if (this.gameState !== 'playing') {
                    console.log(`ğŸ›‘ ØªÙˆÙ‚Ù Ø§Ù„Ø­Ù„Ù‚Ø© - Ø§Ù„Ø­Ø§Ù„Ø©: ${this.gameState}`);
                    return;
                }
                
                // ğŸ”¥ Ø­Ø³Ø§Ø¨ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ù†Ù‚Ø¶ÙŠ
                const deltaTime = (currentTime - this.lastTime) / 1000;
                this.lastTime = currentTime;
                
                // ğŸ”¥ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†Ø§ØµØ±
                this.updatePlayer(deltaTime);
                this.updateEnemies(deltaTime);
                this.updateCoins(deltaTime);
                
                // ğŸ”¥ Ø§Ù„Ø±Ø³Ù…
                this.draw();
                
                // ğŸ”¥ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± ÙÙŠ Ø§Ù„Ø­Ù„Ù‚Ø©
                requestAnimationFrame((time) => this.gameLoop(time));
            }
            
            draw() {
                // ğŸ”¥ Ù…Ø³Ø­ Ø§Ù„Ø´Ø§Ø´Ø©
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                
                // ğŸ”¥ Ø§Ù„Ø®Ù„ÙÙŠØ©
                const gradient = this.ctx.createLinearGradient(0, 0, 0, this.canvas.height);
                gradient.addColorStop(0, '#87CEEB');
                gradient.addColorStop(0.7, '#5DADE2');
                gradient.addColorStop(1, '#3498DB');
                this.ctx.fillStyle = gradient;
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                
                // ğŸ”¥ Ø³Ø­Ø¨
                this.ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
                for (let i = 0; i < 3; i++) {
                    const x = (Date.now() * 0.01 + i * 200) % (this.canvas.width + 200);
                    this.ctx.beginPath();
                    this.ctx.arc(x, 50, 30, 0, Math.PI * 2);
                    this.ctx.arc(x + 40, 50, 40, 0, Math.PI * 2);
                    this.ctx.arc(x + 90, 50, 30, 0, Math.PI * 2);
                    this.ctx.fill();
                }
                
                // ğŸ”¥ Ø§Ù„Ø£Ø±Ø¶ ÙˆØ§Ù„Ù…Ù†ØµØ§Øª
                this.platforms.forEach(platform => {
                    this.ctx.fillStyle = platform.type === 'ground' ? '#8B4513' : '#A0522D';
                    this.ctx.fillRect(platform.x, platform.y, platform.width, platform.height);
                    
                    // ØªÙØ§ØµÙŠÙ„
                    this.ctx.fillStyle = platform.type === 'ground' ? '#A0522D' : '#8B4513';
                    for (let i = 0; i < platform.width; i += 20) {
                        this.ctx.fillRect(platform.x + i, platform.y, 10, 5);
                    }
                });
                
                // ğŸ”¥ Ø§Ù„Ø¹Ù…Ù„Ø§Øª
                this.coinItems.forEach(coin => {
                    if (!coin.collected) {
                        const bounce = Math.sin(coin.anim) * 10;
                        
                        this.ctx.fillStyle = '#FFD700';
                        this.ctx.beginPath();
                        this.ctx.arc(coin.x, coin.y + bounce, 12, 0, Math.PI * 2);
                        this.ctx.fill();
                        
                        this.ctx.fillStyle = '#FFA500';
                        this.ctx.beginPath();
                        this.ctx.arc(coin.x, coin.y + bounce, 8, 0, Math.PI * 2);
                        this.ctx.fill();
                        
                        // Ø¨Ø±ÙŠÙ‚
                        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
                        this.ctx.beginPath();
                        this.ctx.arc(coin.x - 3, coin.y - 3 + bounce, 3, 0, Math.PI * 2);
                        this.ctx.fill();
                    }
                });
                
                // ğŸ”¥ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡
                this.enemies.forEach(enemy => {
                    if (!enemy.active) return;
                    
                    this.ctx.fillStyle = '#EF476F';
                    this.ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
                    
                    // Ø¹ÙŠÙˆÙ†
                    this.ctx.fillStyle = '#2C3E50';
                    this.ctx.fillRect(enemy.x + 10, enemy.y + 10, 8, 8);
                    this.ctx.fillRect(enemy.x + enemy.width - 18, enemy.y + 10, 8, 8);
                    
                    // ÙÙ…
                    this.ctx.fillRect(enemy.x + 15, enemy.y + 30, enemy.width - 30, 5);
                });
                
                // ğŸ”¥ Ø§Ù„Ù„Ø§Ø¹Ø¨
                this.ctx.fillStyle = '#E74C3C';
                this.ctx.fillRect(this.player.x, this.player.y, this.player.width, this.player.height);
                
                // ÙˆØ¬Ù‡ Ø§Ù„Ù„Ø§Ø¹Ø¨
                this.ctx.fillStyle = '#2C3E50';
                this.ctx.fillRect(this.player.x + 10, this.player.y + 10, 20, 20);
                
                // Ø¹ÙŠÙˆÙ† Ø§Ù„Ù„Ø§Ø¹Ø¨
                this.ctx.fillStyle = '#FFF';
                const eyeOffset = this.player.grounded ? 0 : 2;
                this.ctx.fillRect(this.player.x + 15, this.player.y + 15 + eyeOffset, 5, 5);
                this.ctx.fillRect(this.player.x + 25, this.player.y + 15 + eyeOffset, 5, 5);
                
                // ğŸ”¥ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­
                this.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
                this.ctx.fillRect(10, 10, 250, 100);
                
                this.ctx.fillStyle = '#FFF';
                this.ctx.font = '14px Arial';
                this.ctx.fillText(`Ø§Ù„Ø­Ø§Ù„Ø©: ${this.gameState}`, 20, 30);
                this.ctx.fillText(`Ø§Ù„Ù…ÙˆÙ‚Ø¹: (${Math.floor(this.player.x)}, ${Math.floor(this.player.y)})`, 20, 50);
                this.ctx.fillText(`Ø§Ù„ÙˆÙ‚Øª: ${this.timeLeft}Ø« | Ø¹Ù…Ù„Ø§Øª: ${this.coins}/${this.totalCoins}`, 20, 70);
                this.ctx.fillText(`Ø§Ù„Ø£Ø±ÙˆØ§Ø­: ${this.lives} | Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${this.score}`, 20, 90);
            }
            
            pauseGame() {
                console.log('â¸ï¸ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù„Ø¹Ø¨Ø©');
                this.gameState = 'paused';
                clearInterval(this.gameTimer);
                document.getElementById('pause-btn').textContent = 'â–¶';
            }
            
            resumeGame() {
                console.log('â–¶ï¸ Ø§Ø³ØªØ¦Ù†Ø§Ù Ø§Ù„Ù„Ø¹Ø¨Ø©');
                this.gameState = 'playing';
                this.startTimer();
                document.getElementById('pause-btn').textContent = 'â¸';
                this.lastTime = performance.now();
                this.gameLoop();
            }
            
            endGame(isWin, reason = '') {
                console.log(`ğŸ® Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù„Ø¹Ø¨Ø© - ÙÙˆØ²: ${isWin}, Ø§Ù„Ø³Ø¨Ø¨: ${reason}`);
                
                // ğŸ”¥ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¤Ù‚Øª ÙˆØ§Ù„Ø­Ù„Ù‚Ø©
                this.gameState = 'ended';
                clearInterval(this.gameTimer);
                
                // ğŸ”¥ Ø­Ø³Ø§Ø¨ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø³ØªØºØ±Ù‚
                const timeUsed = 120 - this.timeLeft;
                
                // ğŸ”¥ ØªØ­Ø¯ÙŠØ« Ø´Ø§Ø´Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ©
                document.getElementById('end-icon').textContent = isWin ? 'ğŸ†' : 'ğŸ’€';
                document.getElementById('end-title').textContent = isWin ? 'ØªÙ‡Ø§Ù†ÙŠÙ†Ø§!' : 'Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©';
                
                let message = '';
                if (isWin) {
                    message = `Ø¬Ù…Ø¹Øª ${this.coins} Ø¹Ù…Ù„Ø© ÙÙŠ ${this.formatTime(timeUsed)}!`;
                } else {
                    switch(reason) {
                        case 'time':
                            message = 'Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª!';
                            break;
                        case 'lives':
                            message = 'Ù†ÙØ°Øª Ø§Ù„Ø£Ø±ÙˆØ§Ø­!';
                            break;
                        case 'enemy':
                            message = 'Ù‡Ø²Ù…Ùƒ Ø§Ù„Ø¹Ø¯Ùˆ!';
                            break;
                        default:
                            message = 'Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰!';
                    }
                }
                document.getElementById('end-message').textContent = message;
                
                document.getElementById('final-score').textContent = this.score;
                document.getElementById('final-coins').textContent = `${this.coins}/${this.totalCoins}`;
                document.getElementById('final-time').textContent = this.formatTime(timeUsed);
                
                // ğŸ”¥ Ø¥Ø¸Ù‡Ø§Ø± Ø´Ø§Ø´Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ©
                this.showScreen('end');
                
                console.log(`ğŸ“Š Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: ${this.score} Ù†Ù‚Ø·Ø©ØŒ ${this.coins}/${this.totalCoins} Ø¹Ù…Ù„Ø©`);
            }
            
            updateUI() {
                // ğŸ”¥ ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª
                document.getElementById('timer').textContent = this.formatTime(this.timeLeft);
                
                // ğŸ”¥ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†ØªÙŠØ¬Ø©
                document.getElementById('score').textContent = this.score;
                
                // ğŸ”¥ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø±ÙˆØ§Ø­
                document.getElementById('lives').textContent = this.lives;
                
                // ğŸ”¥ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù…Ù„Ø§Øª
                document.getElementById('coins').textContent = `${this.coins}/${this.totalCoins}`;
                
                // ğŸ”¥ ØªØ³Ø¬ÙŠÙ„ ÙÙŠ Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„
                console.log(`ğŸ“Š ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø©: Ø§Ù„ÙˆÙ‚Øª ${this.timeLeft}Ø«ØŒ Ù†ØªÙŠØ¬Ø© ${this.score}ØŒ Ø£Ø±ÙˆØ§Ø­ ${this.lives}ØŒ Ø¹Ù…Ù„Ø§Øª ${this.coins}/${this.totalCoins}`);
            }
            
            formatTime(seconds) {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            }
        }
        
        // ============================================
        // ğŸ”¥ Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        // ============================================
        
        let game;
        
        window.addEventListener('load', () => {
            console.log('ğŸ“„ Ø§Ù„ØµÙØ­Ø© Ù…Ø­Ù…Ù„Ø© - Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©...');
            
            // ğŸ”¥ Ø¥Ø®ÙØ§Ø¡ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¯ÙˆØ±Ø§Ù† Ø¥Ø°Ø§ ÙƒØ§Ù† Ø£ÙÙ‚ÙŠ
            if (window.innerHeight <= window.innerWidth) {
                document.getElementById('rotate-warning').style.display = 'none';
            }
            
            // ğŸ”¥ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© Ù…Ø¨Ø§Ø´Ø±Ø©
            game = new MarioGame();
            console.log('âœ… Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¬Ø§Ù‡Ø²Ø©! Ø§Ø¶ØºØ· Ø²Ø± "ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨"');
            
            // ğŸ”¥ Ø§Ø®ØªØ¨Ø§Ø± Ø²Ø± Ø§Ù„Ø¨Ø¯Ø¡
            const startBtn = document.getElementById('start-btn');
            if (startBtn) {
                startBtn.addEventListener('click', function() {
                    console.log('ğŸ¯ ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¨Ø¯Ø¡ - ØªØ´ØºÙŠÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø©');
                    if (game) {
                        game.startGame();
                    }
                });
            }
            
            // ğŸ”¥ ØªØ­Ø¯ÙŠØ« Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¯ÙˆØ±Ø§Ù† Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø¬Ù…
            window.addEventListener('resize', () => {
                const warning = document.getElementById('rotate-warning');
                if (window.innerHeight > window.innerWidth) {
                    warning.style.display = 'flex';
                } else {
                    warning.style.display = 'none';
                }
            });
            
            // ğŸ”¥ ØªØ«Ø¨ÙŠØª Ø§Ù„Ø¯ÙˆØ±Ø§Ù† Ù„Ù„Ù‡Ø§ØªÙ
            if (screen.orientation && screen.orientation.lock) {
                try {
                    screen.orientation.lock('landscape');
                } catch (e) {
                    console.log('Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ«Ø¨ÙŠØª Ø§Ù„Ø¯ÙˆØ±Ø§Ù†:', e.message);
                }
            }
        });
        
        // ğŸ”¥ Ù…Ù†Ø¹ Ø§Ù„Ø³Ù„ÙˆÙƒ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
        document.addEventListener('contextmenu', e => e.preventDefault());
        
        // ğŸ”¥ Ù…Ù†Ø¹ Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¨Ø§Ù„Ù…ÙØ§ØªÙŠØ­
        window.addEventListener('keydown', (e) => {
            if ([' ', 'ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(e.key)) {
                e.preventDefault();
            }
        });
        
        console.log('ğŸ® ÙƒÙˆØ¯ Ø§Ù„Ù„Ø¹Ø¨Ø© Ù…Ø­Ù…Ù„ Ø¨Ù†Ø¬Ø§Ø­!');
    </script>
</body>
</html>
